(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8270],{946:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin-jobs",function(){return a(3787)}])},3787:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return JobsList}});var n=a(5893),r=a(7294),i=a(1163),o=a(8504),l=a(4744),s=a(1853);let c={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},d=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function parseDateUnit(e){return e?parseInt(e):1}function parseTimeUnit(e){return e&&parseFloat(e.replace(",","."))||0}let p=[31,null,31,30,31,30,31,31,30,31,30,31];function isLeapYearIndex(e){return e%400==0||e%4==0&&e%100!=0}var date_fns_parseISO=function(e,t){let a,n;let r=t?.additionalDigits??2,i=function(e){let t;let a={},n=e.split(c.dateTimeDelimiter);if(n.length>2)return a;if(/:/.test(n[0])?t=n[0]:(a.date=n[0],t=n[1],c.timeZoneDelimiter.test(a.date)&&(a.date=e.split(c.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length))),t){let e=c.timezone.exec(t);e?(a.time=t.replace(e[1],""),a.timezone=e[1]):a.time=t}return a}(e);if(i.date){let e=function(e,t){let a=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:NaN,restDateString:""};let r=n[1]?parseInt(n[1]):null,i=n[2]?parseInt(n[2]):null;return{year:null===i?r:100*i,restDateString:e.slice((n[1]||n[2]).length)}}(i.date,r);a=function(e,t){if(null===t)return new Date(NaN);let a=e.match(d);if(!a)return new Date(NaN);let n=!!a[4],r=parseDateUnit(a[1]),i=parseDateUnit(a[2])-1,o=parseDateUnit(a[3]),l=parseDateUnit(a[4]),s=parseDateUnit(a[5])-1;if(n)return l>=1&&l<=53&&s>=0&&s<=6?function(e,t,a){let n=new Date(0);n.setUTCFullYear(e,0,4);let r=n.getUTCDay()||7;return n.setUTCDate(n.getUTCDate()+((t-1)*7+a+1-r)),n}(t,l,s):new Date(NaN);{let e=new Date(0);return i>=0&&i<=11&&o>=1&&o<=(p[i]||(isLeapYearIndex(t)?29:28))&&r>=1&&r<=(isLeapYearIndex(t)?366:365)?(e.setUTCFullYear(t,i,Math.max(r,o)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);let o=a.getTime(),l=0;if(i.time&&isNaN(l=function(e){let t=e.match(h);if(!t)return NaN;let a=parseTimeUnit(t[1]),n=parseTimeUnit(t[2]),r=parseTimeUnit(t[3]);return(24===a?0===n&&0===r:r>=0&&r<60&&n>=0&&n<60&&a>=0&&a<25)?a*s.vh+n*s.yJ+1e3*r:NaN}(i.time)))return new Date(NaN);if(i.timezone){if(isNaN(n=function(e){if("Z"===e)return 0;let t=e.match(u);if(!t)return 0;let a="+"===t[1]?-1:1,n=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return r>=0&&r<=59?a*(n*s.vh+r*s.yJ):NaN}(i.timezone)))return new Date(NaN)}else{let e=new Date(o+l),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(o+l+n)},f=a(2091),g=a(9471);function JobsList(){let e=(0,i.useRouter)(),{status:t}=e.query,[a,s]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[h,u]=(0,r.useState)(!0),formatSalary=(e,t)=>{let a=(e/1e3).toFixed(0)+"k",n=(t/1e3).toFixed(0)+"k";return"".concat(a,"-").concat(n)},formatJobType=e=>e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ");(0,r.useEffect)(()=>{let fetchJobs=async()=>{u(!0);let a=localStorage.getItem("accessToken");if(!a){e.push("/login");return}let n="".concat(g.Z,"jobs/list/all");"open"===t?n="".concat(g.Z,"jobs/list/open"):"closed"===t&&(n="".concat(g.Z,"jobs/list/closed"));try{let e=await fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(a)}});if(e.ok){let t=await e.json(),a=t.map(e=>({...e,title:formatJobType(e.title),location:formatJobType(e.location),job_type:formatJobType(e.job_type),salary:formatSalary(parseFloat(e.salary_min),parseFloat(e.salary_max)),job_created:(0,l.Z)(date_fns_parseISO(e.job_created),{addSuffix:!0})}));s(a)}else console.error("Failed to fetch jobs")}catch(e){console.error("Error fetching jobs:",e)}finally{u(!1)}};fetchJobs()},[t,e]),(0,r.useEffect)(()=>{let fetchVdIs=async()=>{let t=localStorage.getItem("accessToken");if(!t){e.push("/login");return}try{console.log("Fetching VDIs...");let e=await fetch("".concat(g.Z,"vdi/list"),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}});if(e.ok){let t=await e.json();console.log("VDIs:",t),d(t)}else console.error("Failed to fetch VDIs")}catch(e){console.error("Error fetching VDIs:",e)}};fetchVdIs()},[e]);let handleJobRowClick=t=>{e.push("/create-job?id=".concat(t))},handleApplicantsClick=t=>{e.push("/candidates-grid/".concat(t))},handleStatusChange=async(e,t)=>{let a=localStorage.getItem("accessToken");try{let n=await fetch("".concat(g.Z,"jobs/").concat(e,"/"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({is_active:"Open"===t})});n.ok?s(a=>a.map(a=>a.id===e?{...a,is_active:"Open"===t}:a)):console.error("Failed to update job status")}catch(e){console.error("Error updating job status:",e)}},handleVdiChange=async(e,t)=>{let a=localStorage.getItem("accessToken");try{let n=await fetch("".concat(g.Z,"jobs/vdi/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({job_id:e,vdi_id:t})});n.ok||console.error("Failed to update VDI for the job")}catch(e){console.error("Error updating VDI for the job:",e)}};return(0,n.jsx)(o.Z,{children:(0,n.jsxs)("div",{className:"container",children:[(0,n.jsxs)("h3",{className:"dashboard-section-title",children:["Your Created Jobs (",t||"all",")"]}),h?(0,n.jsx)("p",{children:"Loading jobs..."}):a.length>0?(0,n.jsx)("div",{className:"dashboard-table-wrapper",children:(0,n.jsxs)("table",{className:"dashboard-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Job Title"}),(0,n.jsx)("th",{children:"Location"}),(0,n.jsx)("th",{children:"Type"}),(0,n.jsx)("th",{children:"Posted"}),(0,n.jsx)("th",{children:"Salary"}),(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"VDI"})," ",(0,n.jsx)("th",{children:"Actions"})]})}),(0,n.jsx)("tbody",{children:a.map(e=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{onClick:()=>handleJobRowClick(e.id),children:e.title}),(0,n.jsx)("td",{onClick:()=>handleJobRowClick(e.id),children:e.location}),(0,n.jsx)("td",{onClick:()=>handleJobRowClick(e.id),children:e.job_type}),(0,n.jsx)("td",{onClick:()=>handleJobRowClick(e.id),children:e.job_created}),(0,n.jsx)("td",{onClick:()=>handleJobRowClick(e.id),children:e.salary}),(0,n.jsx)("td",{children:(0,n.jsxs)("select",{value:e.is_active?"Open":"Closed",onChange:t=>handleStatusChange(e.id,t.target.value),style:{paddingRight:"20px",appearance:"none",background:'url(data:image/svg+xml;charset=US-ASCII,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 4 5"><path fill="none" stroke="black" stroke-width=".5" d="M0 0l2 2 2-2"/></svg>) no-repeat right center',backgroundColor:"#fff",backgroundSize:"12px",border:"1px solid #ccc",borderRadius:"4px",padding:"5px",margin:0},children:[(0,n.jsx)("option",{value:"Open",children:"Open"}),(0,n.jsx)("option",{value:"Closed",children:"Closed"})]})}),(0,n.jsx)("td",{children:(0,n.jsxs)("select",{onChange:t=>handleVdiChange(e.id,t.target.value),defaultValue:"",style:{appearance:"none",backgroundColor:"#fff",padding:"5px",border:"1px solid #ccc",borderRadius:"4px"},children:[(0,n.jsx)("option",{value:"",disabled:!0,children:"Select VDI"}),c.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,n.jsxs)("td",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[(0,n.jsx)("span",{onClick:()=>handleApplicantsClick(e.id),style:{cursor:"pointer",color:"blue",textDecoration:"underline"},children:"View Applicants"}),(0,n.jsx)(f.fmQ,{onClick:()=>handleJobRowClick(e.id),style:{cursor:"pointer",color:"blue"}})]})]},e.id))})]})}):(0,n.jsxs)("p",{children:["No jobs found for ",t||"all","."]})]})})}},9471:function(e,t){"use strict";t.Z="http://35.154.204.105/api/"}},function(e){e.O(0,[1653,3365,9865,1998,4744,8504,9774,2888,179],function(){return e(e.s=946)}),_N_E=e.O()}]);