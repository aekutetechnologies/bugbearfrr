(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{1075:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return t(6956)}])},6956:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DashboardWithSidebar}});var a=t(5893),o=t(7294),l=t(1664),n=t.n(l),r=t(1163),d=t(3148),i=t(8504),c=t(6495);d.kL.register(d.qi,d.u,d.De);var elements_JobStats=e=>{let{openJobs:s,closedJobs:t}=e;return(0,a.jsx)("div",{className:"w-full h-64 md:w-1/2 mx-auto",children:(0,a.jsx)(c.$I,{data:{labels:["Open Jobs","Closed Jobs"],datasets:[{label:"Job Status",data:[s,t],backgroundColor:["#2563EB","#F44336"],hoverBackgroundColor:["#64B5F6","#EF5350"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:function(e){let s=e.raw;return" ".concat(e.label,": ").concat(s)}}}}}})})};d.kL.register(d.qi,d.u,d.De);var elements_VdiStats=e=>{let{runningvdi:s,closedvdi:t}=e;(0,o.useEffect)(()=>{s&&t||console.warn("Missing VDI data: running_vdi or closed_vdi might be undefined")},[s,t]);let l={labels:["Running VDI","Closed VDI"],datasets:[{label:"VDI Status",data:[Number(s),Number(t)],backgroundColor:["#2563EB","#F44336"],hoverBackgroundColor:["#64B5F6","#EF5350"],borderWidth:1}]};return(0,a.jsx)("div",{className:"w-full h-64 md:w-1/2 mx-auto",children:0===Number(s)&&0===Number(t)?(0,a.jsx)("p",{className:"text-center text-gray-600",children:"No VDIs created this week."}):(0,a.jsx)(c.$I,{data:l,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},tooltip:{callbacks:{label:function(e){let s=e.raw;return" ".concat(e.label,": ").concat(s)}}}}}})})};function DashboardWithSidebar(){let e=(0,r.useRouter)(),[s,t]=(0,o.useState)({total_jobs:0,open_jobs:0,closed_jobs:0,jobs_over_week:[],total_vdi:0,running_vdi:0,closed_vdi:0}),[l,d]=(0,o.useState)(!0),[c,h]=(0,o.useState)(!1),[b,u]=(0,o.useState)(""),[x,g]=(0,o.useState)(!1);(0,o.useEffect)(()=>{let fetchStats=async()=>{let s=localStorage.getItem("accessToken");if(!s){e.push("/login");return}try{let e=await fetch("".concat(API_BASE_URL,"jobs/stats/"),{method:"GET",headers:{Authorization:"Bearer ".concat(s)}});if(e.ok){let s=await e.json();t({total_jobs:s.total_jobs||0,open_jobs:s.active_jobs||0,closed_jobs:s.inactive_jobs||0,jobs_over_week:s.jobs_over_week||[0,0,0,0,0,0,0],total_vdi:s.total_vdi||0,running_vdi:s.running_vdi||0,closed_vdi:s.closed_vdi||0})}else console.error("Failed to fetch stats")}catch(e){console.error("Error fetching stats:",e)}finally{d(!1)}};fetchStats()},[e]);let handleCreateVDI=async()=>{g(!0);let s=localStorage.getItem("accessToken");if(!s){e.push("/login");return}try{let e=await fetch("".concat(API_BASE_URL,"vdi/create/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({name:b})});e.ok?(h(!1),u("")):console.error("Failed to create VDI")}catch(e){console.error("Error creating VDI:",e)}finally{g(!1)}};return(0,a.jsxs)(i.Z,{children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("main",{className:"py-3",children:[(0,a.jsxs)("div",{className:"dashboard-header",children:[(0,a.jsx)("h3",{className:"dashboard-title",children:"Dashboard"}),(0,a.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,a.jsx)(n(),{href:"/create-job",className:"",children:(0,a.jsx)("button",{className:"px-3 py-2 rounded-lg bg-blue-600 text-white text-lg hover:bg-blue-700 hover:text-black shadow-xl hover:-translate-y-1 transition-transorm ",children:"Create Job"})}),(0,a.jsx)("button",{className:"px-3 py-2 rounded-lg bg-blue-600 text-white text-lg hover:bg-blue-700 hover:text-gray-200 shadow-xl hover:-translate-y-1 transition-transorm ",onClick:()=>h(!0),children:"Create VDI"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:[(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-jobs?status=all"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total Jobs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.total_jobs}),(0,a.jsx)("span",{className:"text-green-600",children:"+25%"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-jobs?status=open"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Open Jobs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.open_jobs}),(0,a.jsx)("span",{className:"text-green-600",children:"+5%"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-jobs?status=closed"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Closed Jobs"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.closed_jobs}),(0,a.jsx)("span",{className:"text-green-600",children:"+12%"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-vdi?status=all"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Total VDI"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.total_vdi}),(0,a.jsx)("span",{className:"text-green-600",children:"+10%"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-vdi?status=running"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Running VDI"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.running_vdi}),(0,a.jsx)("span",{className:"text-green-600",children:"+8%"})]}),(0,a.jsxs)("div",{className:"bg-white shadow-md shadow-blue-200 rounded-lg p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>e.push("/admin-vdi?status=closed"),children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Closed VDI"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-800",children:s.closed_vdi}),(0,a.jsx)("span",{className:"text-green-600",children:"+15%"})]})]}),(0,a.jsxs)("div",{className:"p-6 flex gap-10",children:[(0,a.jsxs)("div",{className:"w-1/2 p-4 bg-white shadow-md shadow-blue-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Jobs Created Over the Week"}),(0,a.jsx)(elements_JobStats,{openJobs:s.open_jobs,closedJobs:s.closed_jobs})]}),(0,a.jsxs)("div",{className:"w-1/2 p-4 bg-white shadow-md shadow-blue-200 rounded-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"VDIs Created Over the Week"}),(0,a.jsx)(elements_VdiStats,{runningvdi:5,closedvdi:4})]})]})]})})}),c&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-md mx-auto p-6 rounded-lg shadow-lg",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4",children:"Create VDI"}),(0,a.jsx)("input",{type:"text",value:b,onChange:e=>u(e.target.value),placeholder:"Enter VDI Name",className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 mb-4"}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",onClick:()=>h(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 ".concat(x?"cursor-not-allowed opacity-50":""),onClick:handleCreateVDI,disabled:x,children:x?"Creating...":"Create"})]})]})})]})}d.kL.register(d.uw,d.f$,d.od,d.jn,d.Dx,d.u,d.De)}},function(e){e.O(0,[1653,2196,9865,3853,8504,9774,2888,179],function(){return e(e.s=1075)}),_N_E=e.O()}]);